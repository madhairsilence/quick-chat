var _defaults={title:"Friendly Chat",description:"Chat description",sender:"Harish",messages:messages},Template={container:'<div class="chat-container"> Container </div>',header:'<div class="chat-header"><div class="chat-title"> ##title## </div><div class="chat-desc"> ##description## </div></div>',messageListContainer:'<ul class="chat-messages">',quoteMessage:'<div class="chat-qmessage">##quoteMessage##</div>',quotePreview:'<div class="chat-qpreview-label"> Quoted </div><div class="chat-qpreview">##quoteMessage##</div class="chat-qpreview">',messageContainer:"<li></li>",message:'<div class="chat-sender">##sender##</div><div class="chat-time">##time##</div><div class="chat-message">##message##</div>',replyButton:'<div class="reply-button">Reply</div>',messageInputContainer:'<div class="chat-new"></div>',messageInput:'<textarea class="chat-input"></textarea>',sendButton:'<div class="send-button"> Send </div>',get:function(e){return this[e]},format:function(e,t){var s=this.get(e);return Object.keys(t).forEach(function(e){t[e]&&(s=s.replace("##"+e+"##",t[e]))}),s}},ChatUI={create:function(e,t){return this.element=Utils.findElement(e),null!=this.element&&0!=this.element.length||console.error("No Element to install plugin "),this.options=t?$.extend(_defaults,t):_defaults,this.buildChatUI(),this},buildContainer:function(){this.container=$(Template.get("container"))},buildHeader:function(){this.header=$(Template.format("header",{title:this.get("title"),description:this.get("description")}))},buildMessages:function(){var e="",t=this;this.messageListContainer=$(Template.get("messageListContainer")),this.get("messages").forEach(function(s,i){s.id||(s.id=i),e=t.addMessage(s)}),this.messageListContainer.append(e)},addMessage:function(e){var t=this,s=$(Template.get("messageContainer")),i=$(Template.get("replyButton"));i.on("click",function(){t.addQuoteMessage(e.message)}),e.quoteMessage&&""!=e.quoteMessage.trim()&&0!=e.quoteMessage.length&&s.append(Template.format("quoteMessage",{quoteMessage:e.quoteMessage})),s.append(Template.format("message",{sender:e.sender,message:e.message,time:Utils.getTime(e.time)})).append(i),this.messageListContainer.append(s)},buildMessageInput:function(){var e=this;this.inputContainer=$(Template.get("messageInputContainer"));var t=$(Template.get("messageInput")),s=$(Template.get("sendButton"));s.on("click",function(){e.options.addAction?e.options.addAction(function(){e.addMessage({sender:"MySelf",message:Utils.findInput().val(),quoteMessage:Utils.findQuoteMessage().html(),time:Utils.getTime()})}):e.addMessage({sender:"MySelf",message:Utils.findInput().val(),quoteMessage:Utils.findQuoteMessage().html(),time:Utils.getTime()}),Utils.findInput().val(""),Utils.findQuoteMessage().remove()}),this.inputContainer.append(t).append(s)},addQuoteMessage:function(e){null==Utils.findQuoteMessage()||0==Utils.findQuoteMessage().length?Utils.findInput().parent().prepend(Template.format("quotePreview",{quoteMessage:e})):Utils.findQuoteMessage().html(e)},buildChatUI:function(){this.buildContainer(),this.buildHeader(),this.buildMessages(),this.buildMessageInput(),this.container.html("").append(this.header).append(this.messageListContainer).append(this.inputContainer),this.element.append(this.container)},get:function(e){return this.options[e]}},Utils={findElement:function(e){return $(e)},findInput:function(){return $(".chat-input")},findQuoteMessage:function(){return $(".chat-qpreview")},getTime:function(e){var e,t="",s=new Date;return e=e?new Date(e):s,t=e&&e.getDate()==s.getDate()&&e.getMonth()==s.getMonth()&&e.getFullYear()==s.getFullYear()?"Today , ":e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear()+" , ",t=t.concat(e.getHours()+":"+e.getMinutes()+":"+e.getSeconds())}};